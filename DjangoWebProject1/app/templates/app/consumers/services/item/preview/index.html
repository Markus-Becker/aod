{% extends "app/base.html" %}

{% block title %} AoD | {{ service.title }} {% endblock title %}

 {% load staticfiles %}

{% block extraCss %}
    <link rel="stylesheet" type="text/css" href="{% static 'app/content/jquery-ui/1.11.3/jquery-ui.min.css' %}" />
    <link rel="stylesheet" type="text/css" href="{% static 'app/content/my-tooltip.css' %}" />
    <link rel="stylesheet" type="text/css" href="{% static 'app/content/bootstrap-table/bootstrap-table.min.css' %}" />
    <link rel="stylesheet" type="text/css" href="{% static 'app/content/jsson-slider/slider.css' %}" />
{% endblock extraCss %}

{% block navbar %}
    {% include "app/navbar-users.html" %}
{% endblock navbar %}


{% block scripts %}
    {% load staticfiles %}
    <script src="{% static 'app/scripts/jquery-1.10.2.js' %}"></script>
    <script src="{% static 'app/scripts/jquery-ui/1.11.3/jquery-ui.min.js' %}"></script>
    <script src="{% static 'app/scripts/multiselect-bootstrap/bootstrap-select.min.js' %}"></script>
    <script src="{% static 'app/scripts/jquery-ui/1.11.3/jquery-ui.min.js' %}"></script>
    <script src="http://maps.googleapis.com/maps/api/js?key=AIzaSyDY0kkJiTPVd2U7aTOAwhc9ySH6oHxOIYM&sensor=false"></script>
    <script src="{% static 'app/scripts/bootstrap-table/dist/bootstrap-table.min.js' %}"></script>
    <script src="{% static 'app/scripts/jquery.blockUI.js' %}" type="text/javascript"></script>
    <script src="{% static 'app/scripts/jssor-slider/jssor.slider.mini.js' %}"></script>
    <script src="{% static 'app/scripts/p4a-lib/cookies.js' %}"></script>
    <script src="{% static 'app/scripts/p4a-lib/ajax-load.js' %}"></script>
    <script src="{% static 'app/scripts/p4a-lib/consumers/services/item/actions.js' %}"></script>
    <script src="{% static 'app/scripts/p4a-lib/consumers/services/item/preview.js' %}"></script>
    
    <script type="text/javascript" src="http://www.skypeassets.com/i/scom/js/skype-uri.js"></script>
    <script type="text/javascript">
    Skype.ui({
        "name": "chat",
        "element": "SkypeButton_Call_magnitakis_1",
        "participants": ["magnitakis"],
        "imageSize": 24
    });
    </script>
    <script type="text/javascript">
        $(document).ready(function () {   
            var url = window.location.pathname;    
            $("#delete_service").click(function () {
                deleteService(url);
            });
            $("#edit_service").click(function () {
                editService(url);
            });

        });

        // Initialize map
        function getMap() {
            // Initiate variables
            var lat, lng;
            // Initiate coordinates
            var coordinates = new google.maps.LatLng('{{ service.latitude }}', '{{ service.longitude }}');
            // Set options
            var mapOptions = {
                zoom: 7,
                center: coordinates,
                mapTypeId: google.maps.MapTypeId.ROADMAP,
                panControl: false,
                scaleControl: false,
                streetViewControl: false,
                zoomControl: true,
                zoomControlOptions: {
                    style: google.maps.ZoomControlStyle.SMALL,  //enables the dimension
                    position: google.maps.ControlPosition.RIGHT_BOTTOM  //position enables
                },
                mapTypeControlOptions: {
                    style: google.maps.MapTypeControlStyle.DROPDOWN_MENU
                }
            };
            var map = new google.maps.Map(document.getElementById('map'), mapOptions);
            var marker = new google.maps.Marker({
                position: coordinates,
                map: map,
                draggable: false
            });

            var infoWindow = new google.maps.InfoWindow({
                content: "<div><b>Latitude:</b> {{ service.latitude }}<br><b>Longitude:</b> {{ service.longitude }}</div>"
            });
            
            // Handle user actions
            google.maps.event.addListener(marker, 'click', function (event) {
                infoWindow.open(map, marker);
            });
            // Set marker in center
            map.setCenter(marker.position);
            marker.setMap(map);
        }

        // Load map
        google.maps.event.addDomListener(window, 'load', getMap);

        var data = [];
        {% if reviews %}
            {% for i in reviews %}

                data.push({'user': '{{ i.user|title }}', 'title': '<a href="{{i.link}}"> {{ i.title }}</a>', 'provider': '{{ i.provider}}', 
                    "price":'{{ i.unit }} {{ i.price }}', 'payment_date': '-', 'payment_status': '-',
                    'purchased_date': '{{ i.purchased_date| date:"Y-m-d H:i" }}'
                    });
            {% endfor %}
        {% endif %}
    </script>
{% endblock scripts %}

{% block content %}
<div class="container body-content" style="margin-top: 50px; padding-bottom:2em;">

    {% block breadcrumb %}
    <ol class="breadcrumb">
        <li><a href="{{ breadcrumb.home }}" class="custom-inactive-breadcrumb"><i class="fa fa-home"></i> Home</a></li>
        <li><a href="{{ breadcrumb.collection }}" class="custom-inactive-breadcrumb">Services</a></li>
        <li class="active">{{ service.title }}</li>
    </ol>
    {% endblock breadcrumb %}


    <div class="col-lg-12 col-sm-12 col-xs-12">

        {% block basicInfo %}
        <div section class="row service-preview-box">
            <!--header-->
            <div style="padding: 1%">
                <div class="row">
                    <header class="col-md-12 col-sm-12 col-lg-12 col-xs-12" title="Service title is {{ service.title }}">
                        <h3 id="title">{{ service.title }}</h3> 
                    </header>
                </div>
                <div class="row">
                    <div class="col-md-4 col-sm-4 col-lg-4 col-xs-12">
                        <span class="fa fa-calendar text-muted"></span> Created at {{ service.created_date| date:"M d, Y"}}
                        <span class="fa fa-clock-o text-muted"></span> {{ service.created_date| date:"H:i"}}
                    </div>
                    <div class="col-md-8 col-sm-8 col-lg-8 col-xs-12">
                        <a href="#" id="delete_service" class="btn btn-default btn-sm pull-right" style="margin-right:5px!important"><i class="fa fa-trash text-danger fa-lg"></i> Remove</a>
                        <a href="modify" id="edit_service" class="btn btn-default btn-sm pull-right" style="margin-right:5px!important"><i class="fa fa-edit text-success fa-lg"></i> Edit</a>
                        <a href="#" class="btn btn-default btn-sm disabled pull-right" style="margin-right:5px!important"><i class="fa fa-print text-muted fa-lg"></i> Print</a>
                        <a href="#" class="btn btn-default btn-sm disabled pull-right" style="margin-right:5px!important"><i class="fa fa-share-alt text-danger fa-lg"></i> Share</a>
                    </div>
                </div>

            </div>
            <div class="tabbable">
                <ul id="tabs" class="nav nav-tabs" data-tabs="tabs">
                    <li role="presentation" class="active" >
                        <a href="#info" data-toggle="tab">
                            <h4><i class="fa fa-bookmark fa-lg"></i> Service details</h4> 
                        </a>
                    </li>
                    <li role="presentation">
                        <a href="#stats" data-toggle="tab">
                            <h4><i class="fa fa-bar-chart-o fa-lg"></i> Statistics</h4>
                        </a>
                    </li> 
                    <li role="presentation">
                        <a href="#support" data-toggle="tab">
                            <h4><i class="fa fa-cogs fa-lg"></i> Technical support</h4> 
                        </a>
                    </li>  
                    <li role="presentation">
                        <a href="#reviews" data-toggle="tab">
                            <h4><i class="fa fa-star-half-empty fa-lg"></i> Reviews</h4>
                        </a>
                    </li> 
                </ul>

                <div id="my-tab-content" class="tab-content" style="border-left:1px solid #d9d9d9; border-right:1px solid #d9d9d9;border-bottom:1px solid #d9d9d9; background-color:#f1f1f1; padding-left:1%;padding-right:1%; border-radius: 0 1px 5px 5px" >                                      
                    <div class="tab-pane active" id="info">
                        {% include "app/consumers/services/item/preview/preview.html" %}
                    </div>

                    <div class="tab-pane fade" id="stats" style="color:black">
                        {% include "app/consumers/services/item/preview/statistics.html" %}
                    </div>


                    <div class="tab-pane fade" id="support" style="color:black">
                        {% include "app/consumers/services/item/preview/technical-support.html" %}
                    </div>


                    <div class="tab-pane fade" id="reviews" style="color:black">
                        {% include "app/consumers/services/item/preview/reviews.html" %}
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-6 col-sm-6 col-lg-6 col-xs-12" title="A set of keywords that characterize the service">
                    <h5 id="keywords" class="pull-left">
                        {% if keywords %}
                            {% for i in keywords %}
                                <a href="#" class="btn btn-default btn-xs" onclick="return false;"><i class="fa fa-tag text-success"></i> {{i.title}}</a>
                            {% empty %}
                                No keywords
                            {% endfor %}
                        {% endif %}
                    </h5>
                </div>
                <div class="col-md-6 col-sm-6 col-lg-6 col-xs-12" title="Last date that the service was modified">
                    {% if service %}
                        {% if service.modified_date|date:"d M Y" != "01 Jan 1970" %}
                            <h6 class="text-muted pull-right"> Last edit at {{ service.modified_date| date:"M d, Y"}} <i class="fa fa-clock-o text-muted"></i> {{ service.modified_date| date:"H:i"}}</h6>
                        {% endif %}
                    {% endif %} 
                </div>
            </div>

        </div>           
        {% endblock basicInfo %}

    </div>
</div>
{% endblock content %}



