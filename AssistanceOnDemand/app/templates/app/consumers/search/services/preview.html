{% extends "app/base.html" %}
{% load i18n %}
{% load l10n %}

{% block title %} AoD | {{ service.title }} {% endblock title %}

 {% load staticfiles %}

{% block extraCss %}
    <link rel="stylesheet" type="text/css" href="{% static 'app/content/jquery-ui/1.11.3/jquery-ui.min.css' %}" />
    <link rel="stylesheet" type="text/css" href="{% static 'app/content/my-tooltip.css' %}" />
    <link rel="stylesheet" type="text/css" href="{% static 'app/content/bootstrap-table/bootstrap-table.min.css' %}" />
    <link rel="stylesheet" type="text/css" href="{% static 'app/content/jsson-slider/slider.css' %}" />
{% endblock extraCss %}


{% block scripts %}
    <script src="{% static 'app/scripts/jquery-1.10.2.js' %}"></script>
    <script src="{% static 'app/scripts/jquery-ui/1.11.3/jquery-ui.min.js' %}"></script>
    <script src="{% static 'app/scripts/multiselect-bootstrap/bootstrap-select.min.js' %}"></script>
    <script src="{% static 'app/scripts/jquery-ui/1.11.3/jquery-ui.min.js' %}"></script>
    {% with 'https://maps.googleapis.com/maps/api/js?key='|add:google_maps_key as google_map_url %}
    <script type="text/javascript" src="{{ google_map_url }}" ></script>
    {% endwith %}
    <script src="{% static 'app/scripts/p4a-lib/cookies.js' %}"></script>
    <script src="{% static 'app/scripts/p4a-lib/google_map.js' %}"></script>
    
    <script type="text/javascript">

        $(document).ready(function(){
            //
            // Initialize map
            //
            if ( "{{ service.location_constraint }}" === "True" ) {
                var coordinates = {"latitude": "{{ service.latitude|unlocalize }}", "longitude": "{{ service.longitude|unlocalize }}", "radius": "{{ service.coverage|unlocalize }}"};
                var loadMap = GoogleMap.load(coordinates, "{{ service.title|capfirst }}", "map" )
                google.maps.event.addDomListener(window, 'load', loadMap);
            }

        }).on('click', "#btn-add-cart", function(event){
            event.preventDefault();
            $.ajax({
                type: 'POST',
                url: $(this).data('url'),
                beforeSend: function (xhr, settings) {
                    $.ajaxSettings.beforeSend(xhr, settings);
                },
                success: function (response) {
                    if (response.state === 1) {
                        window.location.href = "{% url 'cart_preview'%}";
                    }
                    else {
                        alert(gettext("An error occured"));
                    }
                },
                error: function (response) {
                    alert(gettext("An error is occured. The service modification failed"));
                }
            });
            return false;    
        });


        $.ajaxSetup({
            beforeSend: function (xhr, settings) {
                if (!(/^http:.*/.test(settings.url) || /^https:.*/.test(settings.url))) {
                    xhr.setRequestHeader("X-CSRFToken", new Cookies().getValue('csrftoken'));
                }
            }
        });

    </script>
{% endblock scripts %}


{% block content %}
    <div class="container body-content" style="margin-top: 50px; padding-bottom:2em;">

        {% block breadcrumb %}
        <ol class="breadcrumb">
            <li><a href="{% url 'home_page' %}" class="custom-inactive-breadcrumb"><i class="fa fa-home"></i> {% trans 'Home' %}</a></li>
            <li class="active">{% trans 'Search' %}: {{ service.title| title }}</li>
        </ol>
        {% endblock breadcrumb %}

        <div class="col-lg-12 col-sm-12 col-xs-12">
            <div class="row service-consumer-view-box" style="margin-bottom: 2%">
                <div class="row" style="padding-bottom: 1%">
                    <div class="col-lg-6 col-xs-12 col-md-6 col-sm-6 ">
                        {% if service.image %}
                        <img src="{{ MEDIA_URL }}app/services/images/{{ service.image }}" class="img-responsive" style="height: 50%; border-radius:3px 3px" />
                        {% endif %}
                        <hr>
                        <div class="col-lg-4 col-xs-12 col-md-4 col-sm-4 pull-left">
                            <abbr title="{% trans 'Creation date of service' %}"><i class="fa fa-calendar fa-fw text-muted"></i> {{ service.created_date|date:"M d, Y" }}</abbr>
                        </div>
                        <div class="col-lg-5 col-xs-12 col-md-5 col-sm-5">
                            <span class="fa fa-star-o fa-lg star-colorize-yellow star-rating-1"></span>
                            <span class="fa fa-star-o fa-lg star-colorize-yellow star-rating-2"></span>
                            <span class="fa fa-star-o fa-lg star-colorize-yellow star-rating-3"></span>
                            <span class="fa fa-star-o fa-lg star-colorize-yellow star-rating-4"></span>
                            <span class="fa fa-star-o fa-lg star-colorize-yellow star-rating-5"></span>
                            <span><abbr title="{% trans 'The count of comments for this service and its average score' %}"> {{ reviews|default:'0' }} {% trans 'reviews' %}</abbr></span>
                        </div>
                        <div class="col-lg-3 col-xs-12 col-md-3 col-sm-3 pull-right">
                            <i class="fa fa-comments-o fa-lg text-primary"></i> {% if service.comments %} {{ service.comments| default_if_none:'0' }} {% else %} 0 {% endif%} {% trans 'comments' %}
                        </div>
                    </div>
                    <div class="col-lg-6 col-xs-12 col-md-6 col-sm-6 ">
                        <div style="padding-left: 4%">
                            <div class="row">
                                <header class="col-md-12 col-sm-12 col-lg-12 col-xs-12" title="Service title is {{ service.title }}">
                                    <h3 id="title">{{ service.title| title }}</h3>
                                </header>
                            </div>
                            <div class="row" title="Usage cost of service">
                                <div class="col-md-3 col-sm-3 col-lg-3 col-xs-6">
                                    <h5>{% trans 'Price' %}:</h5>
                                </div>
                                <div class="col-md-7 col-sm-7 col-lg-7 col-xs-6" >
                                    {% if service.charging_policy_id != 1 %}
                                    <h5>{{ service.unit }} {{ service.price }}</h5>
                                    {% else %}
                                    <h5>{% trans 'Free' %} </h5>
                                    {% endif %}
                                </div>
                            </div>
                            {% if service.charging_policy_id != 1 %}
                            <div class="row" title="Usage cost of service">
                                <div class="col-md-3 col-sm-3 col-lg-3 col-xs-6">
                                    <h5>{% trans 'Charging policy'%}:</h5>
                                </div>
                                <div class="col-md-7 col-sm-7 col-lg-7 col-xs-6" >
                                    <h5>{{ model.name|capfirst }}</h5>
                                </div>
                            </div>
                            {% endif %}
                            <div class="row" title="{% trans 'Declares the type of service' %}">
                                 <div class="col-md-3 col-sm-3 col-lg-3 col-xs-6">
                                    <h5><abbr title="{% trans 'Declares the type of service' %}">{% trans 'Type' %}:</abbr></h5>
                                </div>
                                <div class="col-md-7 col-sm-7 col-lg-7 col-xs-6" >
                                    <h5>{% if service.type == 'H' %}  {% trans 'Human based' %} {% else %}  {% trans 'Machine based' %} {% endif %}</h5>
                                </div>
                            </div>
                            {% if service.version %}
                                <div class="row" title="{% trans 'The provider declares the licenses for the service.' %}">
                                    <div class="col-md-3 col-sm-3 col-lg-3 col-xs-6">
                                        <h5><abbr title="{% trans 'The provider declares the licenses for the service.' %}"> {% trans 'Version' %}:</abbr></h5>
                                    </div>
                                    <div class="col-md-7 col-sm-7 col-lg-7 col-xs-6" >
                                        <h5>{{ service.version|default_if_none:"Not available" }}</h5>
                                    </div>
                                </div>
                            {% endif %}
                            {% if service.license %}
                                <div class="row" title="{% trans 'The provider declares the licenses for the service.' %}">
                                    <div class="col-md-3 col-sm-3 col-lg-3 col-xs-6">
                                        <h5><abbr title="{% trans 'The provider declares the licenses for the service.' %}"> {% trans 'Licences' %}:</abbr></h5>
                                    </div>
                                    <div class="col-md-7 col-sm-7 col-lg-7 col-xs-6" >
                                        <h5>{{ service.license|default_if_none:"Not available" }}</h5>
                                    </div>
                                </div>
                            {% endif %}
                            <div class="row" title="{% trans 'Service provider information' %}">
                                <div class="col-md-3 col-sm-3 col-lg-3 col-xs-6">
                                    <h5>{% trans 'Provider' %}:</h5>
                                </div>
                                <div class="col-md-7 col-sm-7 col-lg-7 col-xs-6" >
                                    <h5>{% trans 'by' %}<a href="#owner"> {{ provider.name|title }} {{ provider.lastname | title}}</a></h5>
                                </div>
                            </div>
                            <br>
                            <div class="row">
                                <div class="col-md-12 col-sm-12 col-lg-12 col-xs-12 " >
                                    {% if service.charging_policy_id != 1 %}
                                        <button type="button" class="btn btn-md btn-primary disabled"  title="{% trans 'Get the service' %}"> {% trans 'Get the service' %}!</button>
                                    {% else %}
                                        <button type="button" class="btn btn-md btn-primary disabled"  title="{% trans 'Use the service' %}"> {% trans 'Use the service' %}!</button>
                                    {% endif %}
                                    {% if components.add_to_cart and service.charging_policy_id != 1 %}
                                        <span style="text-align: center!important; margin-left:20px; margin-right:20px">{% trans 'or' %}</span>
                                        <button type="button" id="btn-add-cart" class="btn btn-lg btn-success" title="{% trans 'Add to cart' %}" data-url="{% url 'add_item_cart' service.id %}" data-id="{{service.id}}" data-name="{{service.title}}"> {% trans 'Add to cart' %} <span class="fa fa-shopping-cart" style="margin-left:5px;"></span></button>
                                    {% endif %}
                                </div>
                            </div>

                            <br>

                            <div class="row" title="Service provider information">
                                <div class="col-md-12 col-sm-12 col-lg-12 col-xs-12 " >
                                    <h4> 
                                        <span style="margin-right:20px">{% trans 'Not satisfied'%}?</span>
                                        <button type="button" class="btn btn-lg btn-warning" >{% trans 'Try different'%} <span style="margin-left:5px;" class="fa fa-hand-o-up"></span> </button>
                                    </h4>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
                <hr class="service-hr">
                 {% trans 'Related keywords' %}:
                {% if keywords %}
                    {% for i in keywords %}
                        <span style="margin-right:1%"><i class="fa fa-tag text-success"></i> {{ i.title }}</span>
                    {% endfor %}
                {% endif %}
            </div>

            <div class="row  service-consumer-view-box" style="margin-bottom: 2%">
                <div class="jumbotron" style="background-color:white;color:#171717;">
                    <div class="col-lg-12 col-xs-12 col-md-12 col-sm-12">
                        <h3> {% trans 'Brief description' %}<small> </small></h3>
                    </div>
                    <div class="col-lg-12 col-xs-12 col-md-12 col-sm-12 ">
                        <blockquote style="text-align:justify; font-size: 14pt;">
                            <small style="color:black"><i class="fa fa-quote-left text-muted"></i> {{ service.description|capfirst }} <i class="fa fa-quote-right text-muted"></i></small>
                        </blockquote>  
                    </div>
                </div>
            </div>
           
            <div class="row service-consumer-view-box" style="">
                <div class="col-lg-4 col-xs-12 col-md-4 col-sm-4 ">
                    <h4 class="text-center">
                        <span class="fa-stack fa-4x">
                          <i class="fa fa-circle fa-stack-2x text-info"></i>
                          <i class="fa fa-gears fa-stack-1x fa-inverse"></i>
                        </span>
                    </h4>
                    <hr class="service-hr">
                    <article style="text-align:justify">
                        <h4> {% trans 'Requirements'%}.</h4> 
                            {{ service.requirements|default:"None" }}
                    </article>
                </div>

                <div class=" col-lg-4 col-xs-12 col-md-4 col-sm-4">
                    <h4 class="text-center">
                        <span class="fa-stack fa-4x">
                          <i class="fa fa-circle fa-stack-2x text-success"></i>
                          <i class="fa fa-tasks fa-stack-1x fa-inverse"></i>
                        </span>
                    </h4>
                    <hr class="service-hr">
                    <article style="text-align:justify;margin-bottom:1%">
                        <h4> {% trans 'How to install it' %}.</h4> 
                        {{ service.installation_guide|default:"No instructions" }}
                    </article>
            
                    <article style="text-align:justify">
                        <h4> {% trans 'How to use it' %}.</h4> 
                        {{ service.usage_guidelines|default:"No instructions" }}
                    </article>
                </div>

                <div class="col-lg-4 col-xs-12 col-md-4 col-sm-4">
                    <h4 class="text-center">
                        <span class="fa-stack fa-4x">
                          <i class="fa fa-circle fa-stack-2x text-danger " ></i>
                          <i class="fa fa-bell-slash-o fa-stack-1x fa-inverse text-muted"></i>
                        </span>
                    </h4>
                    <hr class="service-hr">
                    <!--map-->  
                    {% if service.location_constraint %}
                        <h4>{% trans 'Locational constraints' %}</h4>
                        <div id="map" style="height:40%; min-height:250px; border:1px solid gray"></div>
                    {% else %}  
                        <i class="fa fa-map-marker text-danger fa-lg fa-fw"></i>  {% trans 'No location constraints' %} 
                    {% endif %}
                    <br>
                    <!--lang-->
                    
                    {% if service.language_constraint %}
                        <h4>{% trans 'Supported languages' %}</h4>
                        {% for l in availableLanguages %}
                            <i class="fa fa-language text-success fa-fw fa-lg"></i>  {{ l }}<br />
                        {% empty %}
                            {% trans 'No language constraints' %}
                        {% endfor %}
                    {% endif %}
                    <br>
                    <!--other-->
                    {% if service.constraints %}
                    <h4>{% trans 'Other constraints' %}</h4>
                    {{ service.constraints  }}

                    {% endif %}
                </div>
            </div>

            <div class="row col-lg-6 col-xs-12 col-md-6 col-sm-6 service-consumer-view-box">
                <div class="row">
                <div class="col-lg-6 col-xs-12 col-md-6 col-sm-6">
                    <h4> {% trans 'Reviews for service' %}</h4>
                    <h5>
                        <small>
                            <span class="fa fa-star-o fa-lg star-colorize-yellow star-rating-1"></span>
                            <span class="fa fa-star-o fa-lg star-colorize-yellow star-rating-2"></span>
                            <span class="fa fa-star-o fa-lg star-colorize-yellow star-rating-3"></span>
                            <span class="fa fa-star-o fa-lg star-colorize-yellow star-rating-4"></span>
                            <span class="fa fa-star-o fa-lg star-colorize-yellow star-rating-5"></span>
                            <span>{% trans 'from' %} {{ reviews|default:'0' }}  {% trans 'reviews' %}</span>
                        </small>
                    </h5>

                    </div>
                    <div class="col-lg-6 col-xs-12 col-md-6 col-sm-6">
                        <div class="row">
                            <div class="col-lg-4 col-xs-6 col-md-4 col-sm-4">
                                <label style="margin-top:-10px">5  {% trans 'stars' %}</label>
                            </div>
                            <div class="col-lg-8 col-xs-6 col-md-8 col-sm-8">
                                  <div class="progress" style="height:10px">
                                    <div class="progress-bar progress-bar-success ui-progressbar-value" role="progressbar" aria-valuenow="{{ reviews|default:'0' }}" aria-valuemin="0" aria-valuemax="0" style="width:5%">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-4 col-xs-6 col-md-4 col-sm-4">
                                <label style="margin-top:-10px">4  {% trans 'stars' %}</label>
                            </div>
                            <div class="col-lg-8 col-xs-6 col-md-8 col-sm-8">
                                  <div class="progress"  style="height:10px">
                                    <div class="progress-bar progress-bar-success ui-progressbar-value" role="progressbar" aria-valuenow="{{ reviews|default:'0' }}" aria-valuemin="0" aria-valuemax="0" style="width:5%">
                                    </div> 
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-4 col-xs-6 col-md-4 col-sm-4">
                                <label style="margin-top:-10px">3  {% trans 'stars' %}</label>
                            </div>
                            <div class="col-lg-8 col-xs-6 col-md-8 col-sm-8">
                                  <div class="progress" style="height:10px">
                                    <div class="progress-bar progress-bar-success ui-progressbar-value" role="progressbar" aria-valuenow="{{ reviews|default:'0' }}" aria-valuemin="0" aria-valuemax="0" style="width:5%;">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-4 col-xs-6 col-md-4 col-sm-4">
                                <label style="margin-top:-10px">2  {% trans 'stars' %}</label>
                            </div>
                            <div class="col-lg-8 col-xs-6 col-md-8 col-sm-8">
                                  <div class="progress" style="height:10px">
                                    <div class="progress-bar progress-bar-success ui-progressbar-value" role="progressbar" aria-valuenow="{{ reviews|default:'0' }}" aria-valuemin="0" aria-valuemax="0" style="width:5%">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-4 col-xs-6 col-md-4 col-sm-4">
                                <label style="margin-top:-10px">1  {% trans 'star' %}</label>
                            </div>
                            <div class="col-lg-8 col-xs-6 col-md-8 col-sm-8">
                                  <div class="progress" style="height:10px">
                                    <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="{{ reviews|default:'0' }}" aria-valuemin="0" aria-valuemax="0" style="width:5%">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <hr class="service-hr">
                {% if reviews == 0 %}
                    {% trans 'No reviews found'%}!
                {% else %}
                    
                {% endif %}
            </div>
        
            <div class="row col-lg-6 col-xs-12 col-md-6 col-sm-6 pull-right service-consumer-view-box" style="height:142px">
                <h4>{% trans 'Tips for first timers' %}</h4>
                <hr class="service-hr" />
            </div>
            <div class="row col-lg-6 col-xs-12 col-md-6 col-sm-6 pull-right service-consumer-view-box" style="height:142px">
                <h4>{% trans 'Technical support' %}</h4>
                <hr class="service-hr" />
            </div>
        </div>
    </div>
{% endblock content %}



